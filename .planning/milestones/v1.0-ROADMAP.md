# Milestone v1.0: MVP

**Status:** SHIPPED 2026-02-07
**Phases:** 1-3
**Total Plans:** 17

## Overview

Build an automated client reminder system for Peninsula Accounting that connects to QuickBooks Online, syncs client data, calculates UK filing deadlines, and sends scheduled email reminders. The journey progresses from establishing the QuickBooks integration foundation and capturing client metadata, through building the rules engine and reminder templates, to automating email delivery and providing a dashboard for monitoring and control.

## Phases

### Phase 1: Foundation & Integration

**Goal**: Accountant can connect QuickBooks account, sync clients automatically, and configure filing metadata for all clients
**Depends on**: Nothing (first phase)
**Requirements**: QBO-01, QBO-02, QBO-03, META-01, META-02, META-03, META-04, META-05, META-06
**Success Criteria** (what must be TRUE):
  1. Accountant can connect QuickBooks Online account via OAuth and see active client list in dashboard
  2. System automatically refreshes OAuth tokens without manual intervention
  3. Accountant can set client type, year-end dates, and VAT details for each client
  4. Accountant can bulk-edit metadata across multiple clients at once
  5. Accountant can import client metadata from CSV to quickly set up initial data
**Plans**: 4 plans

Plans:
- [x] 01-01-PLAN.md -- Project scaffolding, Supabase setup, database schema, env validation
- [x] 01-02-PLAN.md -- QuickBooks OAuth, token management, client sync, onboarding wizard
- [x] 01-03-PLAN.md -- Dashboard layout, client table with inline editing, bulk edit, search/filters, QBO banner
- [x] 01-04-PLAN.md -- CSV import with server-side validation and results summary

### Phase 2: Reminder Engine

**Goal**: System calculates filing deadlines from client metadata and accountant can configure multi-step reminder templates with escalating messaging
**Depends on**: Phase 1
**Requirements**: TMPL-01, TMPL-02, TMPL-03, SCHED-01, SCHED-02, SCHED-03
**Success Criteria** (what must be TRUE):
  1. System automatically calculates UK filing deadlines (Corporation Tax, Companies House, VAT, Self Assessment) from client year-end and VAT quarter dates
  2. Accountant can create reminder templates with multiple steps and configurable delays between steps
  3. Templates support placeholder variables (client name, deadline, days until deadline, etc.) that auto-populate from client data
  4. Accountant can override template content and timing for individual clients who need custom messaging
  5. Daily cron job correctly identifies which reminders are due based on send dates, client status, and pause flags
**Plans**: 8 plans

Plans:
- [x] 02-01-PLAN.md -- Database schema for Phase 2 tables + install react-hook-form and react-big-calendar
- [x] 02-02-PLAN.md -- TDD: UK filing deadline calculators, working day logic, bank holiday cache, rollover
- [x] 02-03-PLAN.md -- TDD: Template variable substitution and field-level override inheritance
- [x] 02-04-PLAN.md -- Template CRUD API and inline accordion step editor UI
- [x] 02-05-PLAN.md -- Filing type assignment, deadline calculation display, per-client deadline overrides
- [x] 02-06-PLAN.md -- Calendar grid view with react-big-calendar showing deadlines across all clients
- [x] 02-07-PLAN.md -- Per-client template override editor with inheritance model
- [x] 02-08-PLAN.md -- Daily cron job, reminder queue builder, pause/unpause and records-received logic

### Phase 3: Delivery & Dashboard

**Goal**: System automatically sends due reminders via email from accountant's domain, tracks delivery status, and provides dashboard for monitoring and control
**Depends on**: Phase 2
**Requirements**: SCHED-04, SCHED-05, EMAIL-01, EMAIL-02, DASH-01, DASH-02, DASH-03
**Success Criteria** (what must be TRUE):
  1. Emails are sent from accountant's verified practice domain via Postmark with correct client details
  2. System tracks email delivery status and displays it in audit log
  3. Dashboard shows client list with traffic-light status indicators (green/amber/red) based on filing deadlines and reminder responses
  4. Dashboard displays chronological audit log of all sent reminders with timestamps and delivery status
  5. Accountant can mark records as received to stop reminder sequences
  6. Accountant can pause and unpause reminders for specific clients
  7. System automatically rolls forward to next year/quarter when current cycle completes
**Plans**: 5 plans

Plans:
- [x] 03-01-PLAN.md -- Email infrastructure: email_log schema, Postmark client, React Email template, sender function
- [x] 03-02-PLAN.md -- Send-emails cron job: process pending queue into Postmark emails
- [x] 03-03-PLAN.md -- Postmark webhook endpoint for delivery/bounce status tracking
- [x] 03-04-PLAN.md -- Dashboard page with summary cards, traffic-light client status, and warning banner
- [x] 03-05-PLAN.md -- Audit log (global + per-client), navigation update, landing page redirect

---

## Milestone Summary

**Key Decisions:**
- Supabase backend for Postgres + Auth + Edge Functions in one platform
- Vercel Pro hosting for native cron jobs
- Postmark for transactional email deliverability
- QuickBooks read-only scope to minimize permissions and risk
- Filing types use TEXT primary keys for code readability
- date-fns + @date-fns/utc for all date formatting and timezone-safe calculations
- Traffic-light status: grey > red > amber > green priority order
- HMAC-SHA256 webhook signature verification
- Queue pattern: cron marks reminders pending, email delivery processes separately
- PostgREST FK join workaround: fetch reference tables separately and map in code

**Issues Resolved:**
- PostgREST PGRST200 FK relationship cache issue (workaround: separate queries)
- Migration naming convention (timestamp format required by Supabase)
- RLS policies needed for anon role to enable PostgREST FK resolution

**Issues Deferred:**
- QuickBooks production app review (sandbox only for now)
- SPF/DKIM/DMARC DNS configuration for Postmark
- Email retry logic (3 retries over 24 hours)

**Technical Debt Incurred:**
- PostgREST FK join workaround in audit-log.ts (separate query instead of join)
- Phase 1 plans 02-04 missing formal SUMMARY.md files (pre-GSD workflow)

---

*For current project status, see .planning/MILESTONES.md*

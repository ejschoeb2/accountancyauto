# Requirements Archive: v1.1 Template & Scheduling Redesign

**Archived:** 2026-02-08
**Status:** SHIPPED

This is the archived requirements specification for v1.1.

---

## v1.1 Requirements

### Rich Text Editor

- [x] **EDIT-01**: User can compose email body with rich text toolbar (bold, italic, underline, lists, links)
- [x] **EDIT-02**: User can insert placeholder variables via slash command (type `/` triggers autocomplete dropdown)
- [x] **EDIT-03**: Placeholders render as styled pills in editor (atomic nodes, cannot be split)
- [x] **EDIT-04**: User can paste content from Word/Outlook without complex styles breaking layout
- [x] **EDIT-05**: Editor sanitizes HTML on save to prevent XSS (blocks script, style, iframe tags)

### Template Management

- [x] **TMPL-01**: User can create standalone email template with name, subject, and rich text body
- [x] **TMPL-02**: User can insert placeholders in subject line via button dropdown
- [x] **TMPL-03**: Template body is stored as TipTap JSON in database
- [x] **TMPL-04**: User can edit existing template and changes load correctly in editor
- [x] **TMPL-05**: User can view list of all email templates

### Email Rendering

- [~] **RNDR-01**: User sees live preview pane updating as they type in editor — DESCOPED (preview UI not needed)
- [~] **RNDR-02**: Preview displays email with sample client data filling placeholders — DESCOPED
- [~] **RNDR-03**: User can select real client from dropdown to preview with actual data — DESCOPED
- [x] **RNDR-04**: TipTap JSON is converted to email-safe HTML via React Email pipeline
- [x] **RNDR-05**: Sent emails render correctly in Gmail, Outlook, and Apple Mail

### Scheduling System

- [x] **SCHD-01**: User can create schedule for a filing type
- [x] **SCHD-02**: User can add multiple steps to schedule (each step = template + timing + urgency)
- [x] **SCHD-03**: User can specify delay in days before deadline for each step
- [x] **SCHD-04**: User can assign email template to each schedule step from template list
- [x] **SCHD-05**: User can reorder schedule steps
- [x] **SCHD-06**: User can view list of all schedules with their filing types
- [x] **SCHD-07**: User can edit schedule (add/remove/reorder steps)
- [x] **SCHD-08**: One template can be used in multiple schedule steps
- [~] **SCHD-09**: User can cancel individual scheduled reminder from schedule view — DEFERRED to v2
- [~] **SCHD-10**: User can reschedule individual reminder to different date — DEFERRED to v2

### Per-Client Overrides

- [~] **OVRD-01**: User can override email template content for specific client — DEFERRED (tables exist, no UI)
- [~] **OVRD-02**: User can override schedule timing for specific client — DEFERRED
- [~] **OVRD-03**: Content overrides apply to template globally — DEFERRED
- [~] **OVRD-04**: Timing overrides apply to specific schedule step — DEFERRED
- [~] **OVRD-05**: Override precedence is clear — DEFERRED

### Ad-Hoc Sending

- [x] **ADHC-01**: User can start ad-hoc send wizard from main navigation
- [x] **ADHC-02**: Step 1: User can select multiple clients via searchable checkbox list
- [x] **ADHC-03**: Step 2: User can pick email template from list
- [x] **ADHC-04**: Step 3: User can preview email with selected clients' data
- [x] **ADHC-05**: Step 3: User can edit subject and body before sending
- [x] **ADHC-06**: Step 4: User sees confirmation modal with send count before final send
- [x] **ADHC-07**: User sees progress indicator during bulk send
- [x] **ADHC-08**: User sees results summary (sent/failed counts) after send completes
- [x] **ADHC-09**: Ad-hoc sends appear in delivery log with "ad-hoc" type indicator

### Data Migration

- [x] **MIGR-01**: Existing reminder_templates automatically convert to email_templates + schedules
- [x] **MIGR-02**: Each step in reminder_templates.steps becomes a schedule_step entry
- [x] **MIGR-03**: Plain text template bodies convert to TipTap JSON (wrapped in paragraph nodes)
- [x] **MIGR-04**: Existing client_template_overrides split into content overrides and timing overrides
- [x] **MIGR-05**: Migration preserves template UUIDs to avoid orphaning overrides
- [x] **MIGR-06**: Data verification query confirms row counts match after migration
- [x] **MIGR-07**: Old tables retained for one release cycle to allow rollback

### Queue Integration

- [x] **QUEU-01**: Queue builder reads from new schedules + schedule_steps tables
- [x] **QUEU-02**: Queue builder resolves email content from email_templates via schedule_step_id
- [x] **QUEU-03**: Queue builder applies content and timing overrides in correct precedence order
- [x] **QUEU-04**: Existing reminder queue continues to function during migration (no disruption)

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| EDIT-01 | Phase 5 | Complete |
| EDIT-02 | Phase 5 | Complete |
| EDIT-03 | Phase 5 | Complete |
| EDIT-04 | Phase 5 | Complete |
| EDIT-05 | Phase 5 | Complete |
| TMPL-01 | Phase 5 | Complete |
| TMPL-02 | Phase 5 | Complete |
| TMPL-03 | Phase 5 | Complete |
| TMPL-04 | Phase 5 | Complete |
| TMPL-05 | Phase 5 | Complete |
| RNDR-01 | Phase 6 | Descoped |
| RNDR-02 | Phase 6 | Descoped |
| RNDR-03 | Phase 6 | Descoped |
| RNDR-04 | Phase 6 | Complete |
| RNDR-05 | Phase 6 | Complete |
| SCHD-01 | Phase 7 | Complete |
| SCHD-02 | Phase 7 | Complete |
| SCHD-03 | Phase 7 | Complete |
| SCHD-04 | Phase 7 | Complete |
| SCHD-05 | Phase 7 | Complete |
| SCHD-06 | Phase 7 | Complete |
| SCHD-07 | Phase 7 | Complete |
| SCHD-08 | Phase 7 | Complete |
| SCHD-09 | Phase 7 | Deferred to v2 |
| SCHD-10 | Phase 7 | Deferred to v2 |
| OVRD-01 | Phase 7 | Deferred |
| OVRD-02 | Phase 7 | Deferred |
| OVRD-03 | Phase 7 | Deferred |
| OVRD-04 | Phase 7 | Deferred |
| OVRD-05 | Phase 7 | Deferred |
| ADHC-01 | Phase 8 | Complete |
| ADHC-02 | Phase 8 | Complete |
| ADHC-03 | Phase 8 | Complete |
| ADHC-04 | Phase 8 | Complete |
| ADHC-05 | Phase 8 | Complete |
| ADHC-06 | Phase 8 | Complete |
| ADHC-07 | Phase 8 | Complete |
| ADHC-08 | Phase 8 | Complete |
| ADHC-09 | Phase 8 | Complete |
| MIGR-01 | Phase 4 | Complete |
| MIGR-02 | Phase 4 | Complete |
| MIGR-03 | Phase 4 | Complete |
| MIGR-04 | Phase 4 | Complete |
| MIGR-05 | Phase 4 | Complete |
| MIGR-06 | Phase 4 | Complete |
| MIGR-07 | Phase 4 | Complete |
| QUEU-01 | Phase 9 | Complete |
| QUEU-02 | Phase 9 | Complete |
| QUEU-03 | Phase 9 | Complete |
| QUEU-04 | Phase 9 | Complete |

## Milestone Summary

**Shipped:** 40 of 50 v1.1 requirements
**Descoped:** 3 (RNDR-01/02/03 — live preview pane not needed)
**Deferred:** 7 (SCHD-09/10 to v2, OVRD-01 through OVRD-05 — tables exist, no UI)
**Dropped:** 0

---
*Archived: 2026-02-08 as part of v1.1 milestone completion*
